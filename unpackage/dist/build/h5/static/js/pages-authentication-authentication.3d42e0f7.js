(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-authentication-authentication"],{"06c9":function(t,e,n){"use strict";var i=n("8456"),r=n.n(i);r.a},"0ca9":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"wrap"},[n("v-uni-view",{staticClass:"tab"},[n("uni-segmented-control",{attrs:{current:t.current,values:t.items,"style-type":"text","active-color":"#FF711B"},on:{clickItem:function(e){e=t.$handleEvent(e),t.onClickItem(e)}}})],1),n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0===t.current,expression:"current === 0"}]},[n("v-uni-view",{staticClass:"photo-box"},[n("v-uni-view",{staticClass:"photo-item photo-front",on:{click:function(e){e=t.$handleEvent(e),t.uploadID(1,"id")}}},[n("v-uni-label",{staticClass:"iconfont iconicon-x"}),n("v-uni-text",[t._v("拍摄身份证首页")]),t.idSrcFront?n("v-uni-image",{staticClass:"id-front",attrs:{src:t.idSrcFront}}):t._e()],1),n("v-uni-view",{staticClass:"photo-item photo-after",on:{click:function(e){e=t.$handleEvent(e),t.uploadID(2,"id")}}},[n("v-uni-label",{staticClass:"iconfont iconicon-x"}),n("v-uni-text",[t._v("拍摄身份证副页")]),t.idSrcAfter?n("v-uni-image",{staticClass:"id-after",attrs:{src:t.idSrcAfter}}):t._e()],1)],1),n("v-uni-view",{staticClass:"tips-label"},[t._v("请核对关键信息")]),n("v-uni-view",{staticClass:"label-item"},[n("v-uni-label",[t._v("证件姓名：")]),n("v-uni-text",[t._v(t._s(t.name))])],1),n("v-uni-view",{staticClass:"label-item"},[n("v-uni-label",[t._v("证件号码：")]),n("v-uni-text",[t._v(t._s(t.id))])],1),n("v-uni-button",{staticClass:"btn",class:t.name&&t.id&&t.idSrcFront&&t.idSrcAfter?"":"disabled",on:{click:function(e){e=t.$handleEvent(e),t.submitId(e)}}},[t._v("提交审核")])],1),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:1===t.current,expression:"current === 1"}]},[n("v-uni-view",{staticClass:"photo-box"},[n("v-uni-view",{staticClass:"photo-item photo-front",on:{click:function(e){e=t.$handleEvent(e),t.uploadID(1,"drive")}}},[n("v-uni-label",{staticClass:"iconfont iconicon-x"}),n("v-uni-text",[t._v("拍摄驾驶证首页")]),t.driveSrcFront?n("v-uni-image",{staticClass:"id-front",attrs:{src:t.driveSrcFront}}):t._e()],1),n("v-uni-view",{staticClass:"photo-item photo-after",on:{click:function(e){e=t.$handleEvent(e),t.uploadID(2,"drive")}}},[n("v-uni-label",{staticClass:"iconfont iconicon-x"}),n("v-uni-text",[t._v("拍摄驾驶证副页")]),t.driveSrcAfter?n("v-uni-image",{staticClass:"id-after",attrs:{src:t.driveSrcAfter}}):t._e()],1)],1),n("v-uni-view",{staticClass:"tips-label"},[t._v("请核对关键信息")]),n("v-uni-view",{staticClass:"label-item"},[n("v-uni-label",[t._v("档案编号："),n("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入档案编号"},on:{blur:function(e){e=t.$handleEvent(e),t.blur(e)}},model:{value:t.driveId,callback:function(e){t.driveId=e},expression:"driveId"}})],1)],1),n("v-uni-button",{staticClass:"btn",class:t.driveId&&t.driveFrontUrl&&t.driveAfterUrl?"":"disabled",on:{click:function(e){e=t.$handleEvent(e),t.submitDrive(e)}}},[t._v("提交并进行人脸识别")])],1)],1)],1)},r=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r})},"32c7":function(t,e,n){"use strict";n.r(e);var i=n("4312"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=r.a},"3fc2":function(t,e,n){"use strict";n.r(e);var i=n("0ca9"),r=n("44ca");for(var a in r)"default"!==a&&function(t){n.d(e,t,function(){return r[t]})}(a);n("cc28");var o=n("2877"),c=Object(o["a"])(r["default"],i["a"],i["b"],!1,null,"6fcefce8",null);e["default"]=c.exports},4312:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c5f6");var i={name:"UniSegmentedControl",props:{current:{type:Number,default:0},values:{type:Array,default:function(){return[]}},activeColor:{type:String,default:"#007aff"},styleType:{type:String,default:"button"}},data:function(){return{currentIndex:0}},watch:{current:function(t){t!==this.currentIndex&&(this.currentIndex=t)}},created:function(){this.currentIndex=this.current},methods:{_onClick:function(t){this.currentIndex!==t&&(this.currentIndex=t,this.$emit("clickItem",t))}}};e.default=i},"44ca":function(t,e,n){"use strict";n.r(e);var i=n("c5fe"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=r.a},"4d79":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"segmented-control",class:{text:"text"===t.styleType},style:{borderColor:"text"===t.styleType?"":t.activeColor}},t._l(t.values,function(e,i){return n("v-uni-view",{key:i,staticClass:"segmented-control-item",class:[{text:"text"===t.styleType},{active:i===t.currentIndex}],style:{color:i===t.currentIndex?"text"===t.styleType?t.activeColor:"#fff":"text"===t.styleType?"#000":t.activeColor,backgroundColor:i===t.currentIndex&&"button"===t.styleType?t.activeColor:""},on:{click:function(e){e=t.$handleEvent(e),t._onClick(i)}}},[t._v(t._s(e))])}),1)},r=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r})},"5e6c":function(t,e,n){"use strict";var i=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.compress=o,e.uploadImg=c;var r=i(n("795b")),a=i(n("e143"));function o(t){return new r.default(function(e,n){try{a.default.prototype.$loading.show({duration:1e5}),uni.getImageInfo({src:t,success:function(t){var n=t.width,i=t.height,r=n/i;n>500&&(n=500,i=Math.floor(n/r));var a=new Image;a.src=t.path;var o=document.createElement("canvas"),c=o.getContext("2d");o.width=n,o.height=i,c.drawImage(a,0,0,n,i),o.toBlob(function(t){var n=window.URL.createObjectURL(t);return e(n)})},complete:function(){a.default.prototype.$loading.hide()}})}catch(i){return n(i)}})}function c(t){return new r.default(function(e,n){try{a.default.prototype.$loading.show({duration:1e5}),uni.uploadFile({url:"/api/user/upload-img",filePath:t,name:"img",success:function(t){var n=JSON.parse(t.data);if(0===n.code)return e(n.data.img);10001===n.code?(uni.removeStorageSync("user"),uni.navigateTo({url:"/pages/login/login"})):a.default.prototype.$toast.info(n.message)},complete:function(){a.default.prototype.$loading.hide()}})}catch(i){return n(i)}})}},"645e":function(t,e,n){"use strict";n.r(e);var i=n("4d79"),r=n("32c7");for(var a in r)"default"!==a&&function(t){n.d(e,t,function(){return r[t]})}(a);n("06c9");var o=n("2877"),c=Object(o["a"])(r["default"],i["a"],i["b"],!1,null,"813598b8",null);e["default"]=c.exports},8456:function(t,e,n){var i=n("f66a");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("0fa433da",i,!0,{sourceMap:!1,shadowMode:!1})},c5fe:function(t,e,n){"use strict";var i=n("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("7f7f"),n("96cf");var r=i(n("3b8d"));n("c5f6");var a=i(n("645e")),o=n("5e6c"),c=n("09ce"),s={data:function(){return{items:["身份认证","驾驶证"],current:0,idSrcFront:"",idSrcAfter:"",driveSrcFront:"",driveSrcAfter:"",name:"",id:"",idFrontUrl:"",idAfterUrl:"",driveFrontUrl:"",driveAfterUrl:"",driveId:"",isIdOk:!1}},components:{uniSegmentedControl:a.default},created:function(){},onLoad:function(t){this.type=t.type||0,this.current=0===Number(this.type)?Number(this.type):1},methods:{onClickItem:function(t){var e=this;this.current!==t&&(this.current=t),this.isIdOk||(this.current=1,this.$toast.info("请先进行身份认证"),setTimeout(function(){e.current=0},500))},uploadID:function(t,e){var n=this;uni.chooseImage({count:1,sizeType:["compressed"],success:function(){var i=(0,r.default)(regeneratorRuntime.mark(function i(r){var a,c,s,u,l;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:if(a=r.tempFilePaths[0],1!==t||"id"!==e){i.next=9;break}return n.idSrcFront=a,i.next=5,(0,o.compress)(a);case 5:c=i.sent,n.upload(c),i.next=37;break;case 9:if(2!==t||"id"!==e){i.next=19;break}return n.idSrcAfter=a,i.next=13,(0,o.compress)(a);case 13:return s=i.sent,i.next=16,(0,o.uploadImg)(s);case 16:n.idAfterUrl=i.sent,i.next=37;break;case 19:if(1!==t||"drive"!==e){i.next=29;break}return n.driveSrcFront=a,i.next=23,(0,o.compress)(a);case 23:return u=i.sent,i.next=26,(0,o.uploadImg)(u);case 26:n.driveFrontUrl=i.sent,i.next=37;break;case 29:if(2!==t||"drive"!==e){i.next=37;break}return n.driveSrcAfter=a,i.next=33,(0,o.compress)(a);case 33:return l=i.sent,i.next=36,(0,o.uploadImg)(l);case 36:n.driveAfterUrl=i.sent;case 37:case"end":return i.stop()}},i,this)}));function a(t){return i.apply(this,arguments)}return a}(),fail:function(t){}})},upload:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.$loading.show({duration:1e5}),uni.uploadFile({url:"/api/app/photo-ocr",filePath:t,name:"image",formData:{type:n||1},success:function(){var i=(0,r.default)(regeneratorRuntime.mark(function i(r){var a;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:if(e.$loading.hide(),a=JSON.parse(r.data),0!==a.code){i.next=17;break}if(1!==n){i.next=11;break}return e.name=a.data.name,e.id=a.data.idcard,i.next=8,(0,o.uploadImg)(t);case 8:e.idFrontUrl=i.sent,i.next=15;break;case 11:return e.driveId=a.data.license_number,i.next=14,(0,o.uploadImg)(t);case 14:e.driveFrontUrl=i.sent;case 15:i.next=18;break;case 17:10001===a.code?(uni.removeStorageSync("user"),uni.navigateTo({url:"/pages/login/login"})):e.$toast.info(a.message);case 18:case"end":return i.stop()}},i,this)}));function a(t){return i.apply(this,arguments)}return a}(),complete:function(){e.$loading.hide()}})},submitId:function(){var t=(0,r.default)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.name&&this.id&&this.idFrontUrl&&this.idAfterUrl){t.next=3;break}return this.$toast.info("识别错误，请正确上传身份证！"),t.abrupt("return");case 3:return e={realname:this.name,id_number:this.id,idcard_pic_1_url:this.idFrontUrl,idcard_pic_2_url:this.idAfterUrl},t.prev=4,t.next=7,this.$store.dispatch("authentication/commitIdcard",e);case 7:this.isIdOk=!0,this.current=1,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](4),this.isIdOk=!1,this.$toast.info(t.t0.message);case 15:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),submitDrive:function(){var t=(0,r.default)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.driveId&&this.driveFrontUrl&&this.driveAfterUrl){t.next=3;break}return this.$toast.info("识别错误，请正确上传驾驶证"),t.abrupt("return");case 3:return e={driver_number:this.driveId,driver_license_1_url:this.driveFrontUrl,driver_license_2_url:this.driveAfterUrl},t.prev=4,t.next=7,this.$store.dispatch("authentication/commitDriver",e);case 7:this.faceAuth(),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),this.$toast.info(t.t0.message);case 13:case"end":return t.stop()}},t,this,[[4,10]])}));function e(){return t.apply(this,arguments)}return e}(),faceAuth:function(){var t=(0,r.default)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$store.dispatch("authentication/getFaceIdToken",{face_return_url:c.faceReturnUrl});case 3:e=t.sent,e&&e.url&&(location.href=e.url),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$toast.info(t.t0.message);case 10:case"end":return t.stop()}},t,this,[[0,7]])}));function e(){return t.apply(this,arguments)}return e}(),blur:function(){window.scrollTo(0,0)}}};e.default=s},cc28:function(t,e,n){"use strict";var i=n("efbe"),r=n.n(i);r.a},eac2:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.tab[data-v-6fcefce8]{border-bottom:%?1?% solid #999}.tab[data-v-6fcefce8] .segmented-control-item{line-height:%?100?%;font-size:%?32?%}.content[data-v-6fcefce8]{padding:0 %?32?%}.content .photo-box[data-v-6fcefce8]{margin-top:%?56?%;margin-bottom:%?40?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.content .photo-box .photo-item[data-v-6fcefce8]{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-flex:0;-webkit-flex:0 0 46%;-ms-flex:0 0 46%;flex:0 0 46%;background:#eee;border-radius:%?8?%;height:%?188?%;margin-right:4%;padding:%?40?% 0;text-align:center;position:relative}.content .photo-box .photo-item[data-v-6fcefce8]:nth-child(2){margin-right:0}.content .photo-box .photo-item .iconfont[data-v-6fcefce8]{display:block;font-size:%?60?%;color:#666;margin-bottom:%?12?%}.content .photo-box .photo-item uni-text[data-v-6fcefce8]{color:#999;font-size:%?28?%}.content .photo-box .photo-item .id-after[data-v-6fcefce8],.content .photo-box .photo-item .id-front[data-v-6fcefce8]{width:100%;height:100%;position:absolute;top:0;left:0}.content .tips-label[data-v-6fcefce8]{color:#333;font-size:%?32?%;margin-bottom:%?10?%}.content .label-item[data-v-6fcefce8]{color:#666;font-size:%?32?%;border-bottom:%?1?% solid #eaeaea;padding:%?20?% 0;margin-bottom:%?20?%}.content .label-item .uni-input[data-v-6fcefce8]{display:inline-block;vertical-align:middle}.content .btn[data-v-6fcefce8]{width:60%;margin:0 auto;position:absolute;bottom:%?100?%;left:0;right:0}.content .btn.disabled[data-v-6fcefce8]{background:rgba(255,144,37,.6)}',""])},efbe:function(t,e,n){var i=n("eac2");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("0506003d",i,!0,{sourceMap:!1,shadowMode:!1})},f66a:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.segmented-control[data-v-813598b8]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:75%;font-size:%?28?%;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 auto;overflow:hidden;border:1px solid;border-radius:%?10?%}.segmented-control.text[data-v-813598b8]{border:0;border-radius:0}.segmented-control-item[data-v-813598b8]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;text-align:center;line-height:%?60?%;-webkit-box-sizing:border-box;box-sizing:border-box;border-left:1px solid}.segmented-control-item.active[data-v-813598b8]{color:#fff}.segmented-control-item.text[data-v-813598b8]{border-left:0;color:#000}.segmented-control-item.text.active[data-v-813598b8]{border-bottom-style:solid}.segmented-control-item[data-v-813598b8]:first-child{border-left-width:0}',""])}}]);